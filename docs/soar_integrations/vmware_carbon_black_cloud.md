# VMware Carbon Black Cloud Integration

The VMware Carbon Black Cloud integration for Chronicle SOAR provides extensive capabilities to interact with the Carbon Black Cloud platform, covering endpoint detection and response (EDR), next-generation antivirus (NGAV), audit and remediation, and vulnerability management features.

## Overview

VMware Carbon Black Cloud is a cloud-native endpoint protection platform (EPP) that consolidates multiple security capabilities. This integration allows security teams to query endpoint data, manage alerts, take response actions on devices, and manage policies directly from SOAR playbooks.

This integration enables Chronicle SOAR to:

*   **Query Endpoint Activity:** Search for processes, network connections, file modifications, and other endpoint events.
*   **Manage Alerts:** Retrieve, update, and dismiss alerts generated by Carbon Black Cloud.
*   **Endpoint Response:** Quarantine/unquarantine devices, manage bypass modes, update policies, and initiate scans.
*   **Reputation Management:** List, create, and delete reputation overrides (block/allow lists) for hashes, certificates, and IT tools.
*   **Vulnerability Management:** List vulnerabilities associated with specific hosts.
*   **Enrichment:** Gather detailed information about endpoints (devices) and alerts.

## Key Actions

The following actions are available through the VMware Carbon Black Cloud (CBCloud) integration:

*   **Execute Entity Processes Search (`cb_cloud_execute_entity_processes_search`)**
    *   Description: Search for processes based on associated entities (IP, Host, User, Hash, Process).
    *   Parameters:
        *   `case_id` (string, required): The ID of the case.
        *   `alert_group_identifiers` (List[string], required): Identifiers for the alert groups.
        *   `start_from_row` (string, optional): Row number to start fetching data from.
        *   `max_rows_to_return` (string, optional): Maximum number of process rows to return.
        *   `create_insight` (bool, optional): Create a SOAR insight based on the process info found.
        *   `target_entities` (List[TargetEntity], optional): Specific target entities to base the search on.
        *   `scope` (string, optional, default="All entities"): Defines the scope for the action.

*   **Device Background Scan (`cb_cloud_device_background_scan`)**
    *   Description: Initiate a background scan on devices identified by IP or Host entities.
    *   Parameters:
        *   `case_id` (string, required): The ID of the case.
        *   `alert_group_identifiers` (List[string], required): Identifiers for the alert groups.
        *   `target_entities` (List[TargetEntity], optional): Specific target entities (IP Address, Hostname).
        *   `scope` (string, optional, default="All entities"): Defines the scope for the action.

*   **List Reputation Overrides (`cb_cloud_list_reputation_overrides`)**
    *   Description: List configured reputation overrides (block/allow lists).
    *   Parameters:
        *   `case_id` (string, required): The ID of the case.
        *   `alert_group_identifiers` (List[string], required): Identifiers for the alert groups.
        *   `reputation_override_list` (List[Any], optional): Filter by override list type (e.g., `["BLACK_LIST"]`, `["WHITE_LIST"]`).
        *   `reputation_override_type` (List[Any], optional): Filter by override type (e.g., `["SHA256"]`, `["CERT"]`).
        *   `start_from_row` (string, optional): Row number to start fetching data from.
        *   `max_rows_to_return` (string, optional): Maximum number of overrides to return.
        *   `rows_sort_order` (List[Any], optional): Sort order based on creation time (e.g., `["ASC"]`, `["DESC"]`).
        *   `target_entities` (List[TargetEntity], optional): Optional list of specific target entities.
        *   `scope` (string, optional, default="All entities"): Defines the scope for the action.

*   **Create Reputation Override for SHA-256 Hash (`cb_cloud_create_a_reputation_override_for_sha_256_hash`)**
    *   Description: Create a reputation override (block/allow) for a specific SHA-256 hash.
    *   Parameters:
        *   `case_id` (string, required): The ID of the case.
        *   `alert_group_identifiers` (List[string], required): Identifiers for the alert groups.
        *   `filename` (string, required): Corresponding filename for the hash.
        *   `reputation_override_list` (List[Any], required): Override list to add to (e.g., `["BLACK_LIST"]`).
        *   `sha_256_hash` (string, optional): SHA-256 hash to override (can also be provided via FileHash entity).
        *   `description` (string, optional): Description for the override.
        *   `target_entities` (List[TargetEntity], optional): Optional FileHash entity.
        *   `scope` (string, optional, default="All entities"): Defines the scope for the action.

*   **Create Reputation Override for Certificate (`cb_cloud_create_a_reputation_override_for_certificate`)**
    *   Description: Create a reputation override for a specific certificate signer.
    *   Parameters:
        *   `case_id` (string, required): The ID of the case.
        *   `alert_group_identifiers` (List[string], required): Identifiers for the alert groups.
        *   `signed_by` (string, required): Name of the certificate signer.
        *   `reputation_override_list` (List[Any], required): Override list to add to (e.g., `["WHITE_LIST"]`).
        *   `certificate_authority` (string, optional): Authorizing Certificate Authority.
        *   `description` (string, optional): Description for the override.
        *   `target_entities` (List[TargetEntity], optional): Optional list of specific target entities.
        *   `scope` (string, optional, default="All entities"): Defines the scope for the action.

*   **Quarantine Device (`cb_cloud_quarantine_device`)**
    *   Description: Place devices (identified by IP or Host entities) into network quarantine.
    *   Parameters:
        *   `case_id` (string, required): The ID of the case.
        *   `alert_group_identifiers` (List[string], required): Identifiers for the alert groups.
        *   `target_entities` (List[TargetEntity], optional): Specific target entities (IP Address, Hostname).
        *   `scope` (string, optional, default="All entities"): Defines the scope for the action.

*   **Ping (`cb_cloud_ping`)**
    *   Description: Test connectivity to the VMware Carbon Black Cloud API.
    *   Parameters:
        *   `case_id` (string, required): The ID of the case.
        *   `alert_group_identifiers` (List[string], required): Identifiers for the alert groups.
        *   `target_entities` (List[TargetEntity], optional): Optional list of specific target entities.
        *   `scope` (string, optional, default="All entities"): Defines the scope for the action.

*   **Enable Bypass Mode for Device (`cb_cloud_enable_bypass_mode_for_device`)**
    *   Description: Enable bypass mode (disables prevention policies) for devices (identified by IP or Host entities).
    *   Parameters:
        *   `case_id` (string, required): The ID of the case.
        *   `alert_group_identifiers` (List[string], required): Identifiers for the alert groups.
        *   `target_entities` (List[TargetEntity], optional): Specific target entities (IP Address, Hostname).
        *   `scope` (string, optional, default="All entities"): Defines the scope for the action.

*   **Create Reputation Override for IT Tool (`cb_cloud_create_a_reputation_override_for_it_tool`)**
    *   Description: Create a reputation override for an IT tool based on its file path and optional filename.
    *   Parameters:
        *   `case_id` (string, required): The ID of the case.
        *   `alert_group_identifiers` (List[string], required): Identifiers for the alert groups.
        *   `file_path` (string, required): File path where the IT tool is stored (e.g., `C:\TMP\`).
        *   `reputation_override_list` (List[Any], required): Override list to add to (e.g., `["WHITE_LIST"]`).
        *   `file_name` (string, optional): Filename of the IT tool (can also be provided via File entity).
        *   `description` (string, optional): Description for the override.
        *   `include_child_processes` (bool, optional): Also approve child processes of the IT tool.
        *   `target_entities` (List[TargetEntity], optional): Optional File entity.
        *   `scope` (string, optional, default="All entities"): Defines the scope for the action.

*   **Enrich Entities (`cb_cloud_enrich_entities`)**
    *   Description: Enrich Host or IP entities with device information from Carbon Black Cloud.
    *   Parameters:
        *   `case_id` (string, required): The ID of the case.
        *   `alert_group_identifiers` (List[string], required): Identifiers for the alert groups.
        *   `target_entities` (List[TargetEntity], optional): Specific target entities (IP Address, Hostname).
        *   `scope` (string, optional, default="All entities"): Defines the scope for the action.

*   **Update Policy for Device by Policy ID (`cb_cloud_update_a_policy_for_device_by_policy_id`)**
    *   Description: Assign a specific policy (by ID) to devices (identified by IP or Host entities).
    *   Parameters:
        *   `case_id` (string, required): The ID of the case.
        *   `alert_group_identifiers` (List[string], required): Identifiers for the alert groups.
        *   `policy_id` (string, required): The ID of the policy to assign.
        *   `target_entities` (List[TargetEntity], optional): Specific target entities (IP Address, Hostname).
        *   `scope` (string, optional, default="All entities"): Defines the scope for the action.

*   **Dismiss VMware Carbon Black Cloud Alert (`cb_cloud_dismiss_v_mware_carbon_black_cloud_alert`)**
    *   Description: Dismiss an alert within Carbon Black Cloud.
    *   Parameters:
        *   `case_id` (string, required): The ID of the case.
        *   `alert_group_identifiers` (List[string], required): Identifiers for the alert groups.
        *   `alert_id` (string, required): The Carbon Black Cloud internal alert ID (not the UI display ID).
        *   `reason_for_dismissal` (List[Any], required): Reason code for dismissal (e.g., `["FALSE_POSITIVE"]`).
        *   `determination` (List[Any], required): Determination code (e.g., `["TRUE_POSITIVE_BENIGN"]`).
        *   `message_for_alert_dismissal` (string, optional): Comment to add to the dismissal.
        *   `target_entities` (List[TargetEntity], optional): Optional list of specific target entities.
        *   `scope` (string, optional, default="All entities"): Defines the scope for the action.

*   **List Host Vulnerabilities (`cb_cloud_list_host_vulnerabilities`)**
    *   Description: List vulnerabilities found on specific hosts (identified by IP or Hostname).
    *   Parameters:
        *   `case_id` (string, required): The ID of the case.
        *   `alert_group_identifiers` (List[string], required): Identifiers for the alert groups.
        *   `severity_filter` (string, optional): Comma-separated list of severities to filter (e.g., `Critical,Important`).
        *   `max_vulnerabilities_to_return` (string, optional): Maximum vulnerabilities to return per host.
        *   `target_entities` (List[TargetEntity], optional): Specific target entities (IP Address, Hostname).
        *   `scope` (string, optional, default="All entities"): Defines the scope for the action.

*   **Delete Reputation Override (`cb_cloud_delete_a_reputation_override`)**
    *   Description: Delete a specific reputation override by its ID.
    *   Parameters:
        *   `case_id` (string, required): The ID of the case.
        *   `alert_group_identifiers` (List[string], required): Identifiers for the alert groups.
        *   `reputation_override_id` (string, required): The ID of the reputation override to delete.
        *   `target_entities` (List[TargetEntity], optional): Optional list of specific target entities.
        *   `scope` (string, optional, default="All entities"): Defines the scope for the action.

*   **Unquarantine Device (`cb_cloud_unquarantine_device`)**
    *   Description: Remove devices (identified by IP or Host entities) from network quarantine.
    *   Parameters:
        *   `case_id` (string, required): The ID of the case.
        *   `alert_group_identifiers` (List[string], required): Identifiers for the alert groups.
        *   `target_entities` (List[TargetEntity], optional): Specific target entities (IP Address, Hostname).
        *   `scope` (string, optional, default="All entities"): Defines the scope for the action.

*   **Disable Bypass Mode for Device (`cb_cloud_disable_bypass_mode_for_device`)**
    *   Description: Disable bypass mode (re-enables prevention policies) for devices (identified by IP or Host entities).
    *   Parameters:
        *   `case_id` (string, required): The ID of the case.
        *   `alert_group_identifiers` (List[string], required): Identifiers for the alert groups.
        *   `target_entities` (List[TargetEntity], optional): Specific target entities (IP Address, Hostname).
        *   `scope` (string, optional, default="All entities"): Defines the scope for the action.

## Configuration

*(Details on configuring the integration, including the Carbon Black Cloud URL (API endpoint), Org Key, API ID, and API Secret Key, along with any specific SOAR platform settings, should be added here.)*
